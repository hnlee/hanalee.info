
```{r}
warringer.data <- read.csv("warringer_data.csv", header=T)
head(warringer.data)[,1:10]
head(warringer.data$Variable)

rate.data <- warringer.data[warringer.data$Variable=="Rate",]
head(rate.data[,1:10])

head(rate.data$Class)
rate.data$Environment[rate.data$Class=="Toxins"][1:25]
rate.data$Environment[rate.data$Class=="Toxins"][26:50]
rate.data$Environment[rate.data$Class=="Toxins"][51:75]
rate.data$Environment[rate.data$Class=="Environment & Metabolites"]
rate.data$Environment[rate.data$Class=="Nutrient requirements"][1:20]
rate.data$Environment[rate.data$Class=="Nutrient requirements"][21:40]

oxidative <- c("1,2,4-Aminotriazole 300mM",
               "1,2,4-Aminotriazole 450 mM",
               "DTT 1.6mM",
               "DTT 1.8mM",
               "Paraquat 250\302\265g/mL",
               "Paraquat 400\302\265g/mL")
oxidative
oxidative.labels <- c("300 mM AMT",
                      "450 mM AMT",
                      "1.6 mM DTT",
                      "1.8 mM DTT",
                      "250 ug/mL paraquat",
                      "400 ug/mL paraquat")

metal.toxic <- c("CdCl2 100\302\265M",
                 "CdCl2 150\302\265M",
                 "CoCl2 0.015mM",
                 "CoCl2 0.01mM",
                 "CuCl2 0.375mM", 
                 "CuCl2 0.75mM", 
                 "NiCl2 0.375mM", 
                 "NiCl2 0.75mM")
metal.toxic
toxic.labels <- c("100 uM CdCl2",
                  "150 uM CdCl2",
                  "0.015 mM CoCl2",
                  "0.01 mM CoCl2",
                  "0.375 mM CuCl2",
                  "0.75 mM CuCl2",
                  "0.375 mM NiCl2",
                  "0.75 mM NiCl2")

metal.depletion <- c("Copper depletion, no stress preculture",
                     "Iron depletion, same in preculture",
                     "Lacking molybden, same in preculture",
                     "Zinc depletion, same in preculture")
metal.depletion
depletion.labels <- c("Copper depletion",
                      "Iron depletion",
                      "Molybdenium depletion",
                      "Zinc depletion")

colnames(rate.data)
scer <- c("S288c","Y55","SK1","YJM978","YJM981","YJM975","X322134S","X378604X",
          "X273614X","DBVPG1788", "DBVPG1373","DBVPG6040","NCYC361","YPS606",
          "YPS128","YS2","YS4","YS9","UWOPS03.461.4","UWOPS05.217.3",
          "UWOPS05.227.2","K11","Y9","DBVPG1853","Y12","NCYC110","DBVPG6044",
          "DBVPG6765","L.1374","L.1528","UWOPS87.2421","DBVPG1106",
          "UWOPS83.787.3","BC187","W303","YIIc17_E5","RM11","YJM789")
scer.nonmosaic <- c("YJM978","YJM981","YJM975","DBVPG1788", "DBVPG1373",
                    "YPS606","YPS128","UWOPS03.461.4","UWOPS05.217.3",
                    "UWOPS05.227.2","K11","Y9","Y12","NCYC110","DBVPG6044",
                    "DBVPG6765","L.1374","L.1528","DBVPG1106","BC187","RM11")
scer
scer.nonmosaic
scer.labels <- c("Lab","Mosaic","Lab","Wine/European","Wine/European",
                 "Wine/European","Mosaic","Mosaic","Mosaic","Wine/European",
                 "Wine/European","Mosaic","Mosaic","N. American","N. American",
                 "Mosaic","Mosaic","Mosaic","Malaysian","Malaysian","Malaysian",
                 "Sake","Sake","Mosaic","Sake","W. African","W.African",
                 "Wine/European","Wine/European","Wine/European","Mosaic",
                 "Wine/European","Mosaic","Wine/European","Lab","Mosaic",
                 "Wine/European","Mosaic")
nonmosaic.labels <- c("Wine/European","Wine/European","Wine/European",
                      "Wine/European","Wine/European","N. American",
                      "N. American","Malaysian","Malaysian","Malaysian",
                      "Sake","Sake","Sake","W. African","W. African",
                      "Wine/European","Wine/European","Wine/European",
                      "Wine/European","Wine/European","Wine/European")

scer.rates <- rate.data[,c("Environment",scer)]
nonmosaic.rates <- rate.data[,c("Environment",scer.nonmosaic)] 
head(scer.rates[,1:10])
head(nonmosaic.rates[,1:10])

malaysian <- c("UWOPS03.461.4","UWOPS05.217.3","UWOPS05.227.2")
nonmalaysian.scer <- setdiff(scer,malaysian)
nonmalaysian.nonmosaic <- setdiff(scer.nonmosaic,malaysian)
nonmalaysian.scer
nonmalaysian.nonmosaic

head(scer.rates[scer.rates$Environment %in% oxidative,1:10])
oxidative.rates <- scer.rates[scer.rates$Environment %in% oxidative,
                              c("Environment",malaysian,nonmalaysian.scer)]
rownames(oxidative.rates) <- oxidative.rates$Environment
oxidative.rates[,1:10]

toxic.rates <- scer.rates[scer.rates$Environment %in% metal.toxic,
                          c("Environment",malaysian,nonmalaysian.scer)]
rownames(toxic.rates) <- toxic.rates$Environment
toxic.rates[,1:7]
toxic.rates[,8:15]
toxic.rates[,16:23]
toxic.rates[,24:31]
toxic.rates[,32:39]

depletion.rates <- scer.rates[scer.rates$Environment %in% metal.depletion,
                              c("Environment",malaysian,nonmalaysian.scer)]
rownames(depletion.rates) <- depletion.rates$Environment

library(gplots)
library(RColorBrewer)
redblue <- brewer.pal(11, name="RdBu")

scer.labels
scer

png("scer_oxidative.png", width=500, height=500)
heatmap.2(t(as.matrix(oxidative.rates[oxidative,scer])),
          col=redblue(256),
          symbreaks=T,
          Colv=FALSE,
          cexCol=1, cexRow=1,
          dendrogram="row",
          scale="none",
          colsep=1:length(oxidative),
          rowsep=1:length(scer),
          sepwidth=c(0.005,0.05),
          density.info="none",
          trace="none",
          margins=c(10,7),
          lhei=c(0.8,4),
          lwid=c(2,4),
          labRow=scer.labels, labCol=oxidative.labels)
dev.off()

png("nonmosaic_oxidative.png", width=500, height=500)
heatmap.2(t(as.matrix(oxidative.rates[oxidative,scer.nonmosaic])),
          col=redblue(256),
          symbreaks=T,
          Colv=FALSE,
          cexCol=0.8, cexRow=0.8,
          dendrogram="row",
          scale="none",
          colsep=1:length(oxidative),
          rowsep=1:length(scer.nonmosaic),
          sepwidth=c(0.005,0.05),
          density.info="none",
          trace="none",
          margins=c(10,7),
          lhei=c(0.8,4),
          lwid=c(2,4),
          labRow=nonmosaic.labels, labCol=oxidative.labels)
dev.off()

png("scer_toxic.png", width=500, height=500)
heatmap.2(t(as.matrix(toxic.rates[metal.toxic,setdiff(scer,"RM11")])),
          col=redblue(256),
          symbreaks=T,
          Colv=FALSE,
          cexCol=0.8, cexRow=0.8,
          dendrogram="row",
          scale="none",
          colsep=1:length(metal.toxic),
          rowsep=1:length(scer),
          sepwidth=c(0.005,0.05),
          density.info="none",
          trace="none",
          margins=c(10,7),
          lhei=c(0.8,4),
          lwid=c(2,4),
          labRow=scer.labels, labCol=toxic.labels)
dev.off()

png("nonmosaic_toxic.png", width=500, height=500)
heatmap.2(t(as.matrix(toxic.rates[metal.toxic,setdiff(scer.nonmosaic,"RM11")])),
          col=redblue(256),
          symbreaks=T,
          Colv=FALSE,
          cexCol=0.8, cexRow=0.8,
          dendrogram="row",
          scale="none",
          colsep=1:length(metal.toxic),
          rowsep=1:length(scer.nonmosaic),
          sepwidth=c(0.005,0.05),
          density.info="none",
          trace="none",
          margins=c(10,7),
          lhei=c(0.8,4),
          lwid=c(2,4),
          labRow=nonmosaic.labels, labCol=toxic.labels)
dev.off()

png("scer_depletion.png", width=500, height=500)
heatmap.2(t(as.matrix(depletion.rates[metal.depletion,scer])),
          col=redblue(256),
          symbreaks=T,
          Colv=FALSE,
          cexCol=0.8, cexRow=0.8,
          dendrogram="row",
          scale="none",
          colsep=1:length(metal.depletion),
          rowsep=1:length(scer),
          sepwidth=c(0.005,0.05),
          density.info="none",
          trace="none",
          margins=c(10,7),
          lhei=c(0.8,4),
          lwid=c(2,4),
          labRow=scer.labels, labCol=depletion.labels)
dev.off()

png("nonmosaic_depletion.png", width=500, height=500)
heatmap.2(t(as.matrix(depletion.rates[metal.depletion,scer.nonmosaic])),
          col=redblue(256),
          symbreaks=T,
          Colv=FALSE,
          cexCol=0.8, cexRow=0.8,
          dendrogram="row",
          scale="none",
          colsep=1:length(metal.depletion),
          rowsep=1:length(scer.nonmosaic),
          sepwidth=c(0.005,0.05),
          density.info="none",
          trace="none",
          margins=c(10,7),
          lhei=c(0.8,4),
          lwid=c(2,4),
          labRow=nonmosaic.labels, labCol=depletion.labels)
dev.off()

```
